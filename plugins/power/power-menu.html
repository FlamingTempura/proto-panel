<!DOCTYPE HTML>
<html>
<head>
	<link rel="stylesheet" href="../../style.css">
</head>
<body id="battery-menu" class="menu">
	<div class="container">
		<div class="item" id="battery-summary">
			
		</div>
		<!-- <div class="item">
			Usage graph
		</div> -->
		<div class="separator"></div>
		<div class="header">Display Brightness</div>
		<div class="item">
			<div id="brightness-slider" class="slider">
				<div class="bar"></div>
				<div class="bar-active"></div>
				<button class="handle"></button>
			</div>
		</div>
		<div class="separator"></div>
		<button class="item" id="power-manager">
			Power settings
		</button>
	</div>
<script>
'use strict';

const { getAPI, $, createSlider, log } = require('../../client-utils.js');

getAPI('power').then(power => {

	power.battery().listen(battery => {
		$('#battery-summary').textContent = battery.charging ?
			`${battery.percent}% charging` :
			`${battery.hours} hours and ${battery.minutes} minutes remaining (${battery.percent}%)`;
	});

	
	$('#power-manager').onclick = () => power.openPowerManager();
	
	let $slider = $('#brightness-slider');
	power.getMaxBrightness().then(maxBrightness => {
		log('max', maxBrightness)
		createSlider($slider, 0, maxBrightness);
		$slider.addEventListener('change', () => {
			power.setBrightness(Math.round($slider.getValue()));
		});
		power.brightness().listen(brightness => {
			$slider.setValue(brightness);
			log('boo', brightness)
		});
	});
});
</script>
</body>
</html>>