<style>
#panel #net-wifi-status {
	margin-top: -1px;
}
.flash {
	animation: flash 1s ease infinite;
}

@keyframes flash {
  50% {
    opacity: 0;
  }
}
</style>

<button class="applet" id="network">
	<div class="icon">
		<img id="net-none" class="active" src="plugins/network/net-none.svg">
		<img id="net-wifi" class="inactive" src="plugins/network/net-wifi.svg">
		<div id="net-wifi-status" class="status">
			<img id="net-wifi-status-icon" class="active" src="plugins/network/net-wifi.svg">
		</div>
	</div>
</button>
<script>
(function () {
'use strict';

const { getAPI, $, log } = require('./client-utils.js');

getAPI('network').then(network => {
	$('#network').addEventListener('click', () => network.openMenu());

	network.listen().listen(net => {
		$('#network').title = net.name ? `Connected to ${net.name}.` : 'Not connected.';
		$('#net-none').style.display = `${net.status === 'disconnected' ? 'block' : 'none'}`;
		$('#net-wifi').style.display = `${net.status !== 'disconnected' ? 'block' : 'none'}`;
		$('#net-wifi-status').classList.toggle('flash', net.status === 'waiting');
		$('#net-wifi-status').style.display = `${net.status !== 'disconnected' ? 'block' : 'none'}`;
		$('#net-wifi-status-icon').style.top = `${100 - net.strength}%`;
		$('#net-wifi-status-icon').style.height = `${net.strength}%`;
		$('#net-wifi-status-icon').style.left = `${(100 - net.strength) / 2}%`;
		$('#net-wifi-status-icon').style.width = `${net.strength}%`;
	});

	//network.openMenu();
});
}());
</script>